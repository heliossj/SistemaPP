@model Sistema.Models.VendasOS
@using Sistema.Util
@{
    ViewBag.Title = "Venda ";
    ViewBag.Layout = "~/_Styles/Style.css";
    ViewBag.readOnly = false;
    ViewBag.action = ViewContext.Controller.ValueProvider.GetValue("action").RawValue.ToString().ToLower();
    var Executante = new Sistema.Select.Funcionarios.Select();
    var Servico = new Sistema.Select.Servicos.Select();
    var nrOS = Model.codOrdemServico.ToString();
}

@Html.HiddenFor(u => Model.codOrdemServico)
@Html.HiddenFor(u => Model.codigo)
@Html.Hidden("flTblServicos")
@Html.Hidden("flTblProdutos")
@using (Html.BeginForm())
{
    <div class="container-fluid">
        <div class="container">
            <div class="horizontal">
                <div class="verticals ten offset-by-one">
                    <ol class="breadcrumb breadcrumb-fill2">
                        <li class="active"><a href="@Url.Action("Index")"><i class="fa fa-home"></i></a> </li>
                        <li style="margin-right:-5px; font-weight:500">   -  @ViewBag.Title - Referente a Ordem de Serviço @nrOS </li>
                    </ol>
                </div>
            </div>
        </div>

        <div class="pull-left col-lg-12 col-md-12 col-sm-10 col-xs-10">
            @Html.RenderFlashMessage()
            @Html.CustomValidationSummary(true, true, Sistema.Util.AlertMessage.VALIDATION_MESSAGE, new { @class = "alert alert-danger", role = "alert" })
            <p style="text-align: right; color: red; font-size:16px; font-weight: bold;">* Campos obrigatórios</p>

            <div class="form-row">
                @Html.EditorFor(model => model.Funcionario, "Funcionarios/Select", new { Required = true, Disabled = false, Label = "Vendedor" })
            </div>

            <div class="form-row">
                @Html.EditorFor(model => model.Cliente, "Clientes/Select", new { Required = true, Disabled = false })
            </div>





            <ul class="nav nav-tabs" id="myTab" role="tablist">
                <li class="nav-item">
                    <a class="nav-link active" id="profile-tab" data-toggle="tab" href="#servico" role="tab" aria-controls="profile" aria-selected="false">Serviços</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" id="home-tab" data-toggle="tab" href="#produto" role="tab" aria-controls="home" aria-selected="true">Produtos</a>
                </li>
            </ul>

            <div class="tab-content bs-callout bs-callout-primary" id="myTabContent" style="margin-top:-1px">

                @*SERVIÇO*@
                <div class="tab-pane fade show active" id="servico" role="tabpanel" aria-labelledby="profile-tab">
                    <div id="divAddServico">

                        <div class="form-row">
                            @Html.EditorFor(model => Executante, "Executante/Select", new { Required = true, Disabled = false, Label = "Executante" })
                        </div>

                        <div class="form-row">
                            @Html.EditorFor(model => Servico, "Servicos/Select", new { Disabled = false, Required = true, classForm = Util.Input10, @flValor = "S", @flUnidade = "S", @flQuantidade = "S", flTotalServico = "S" })

                            <div style="margin-block:-1px">
                                <button id="addServico" type="button" class="btn btn-success btn-lg" style="margin-top:35px; font-size:14px" title="Adicionar"><b>Adicionar </b> <i class="fa fa-plus"></i></button>
                            </div>
                        </div>

                    </div>

                    @Html.HiddenFor(model => model.jsServicos)
                    <table id="tblServico" class="table table-striped table-bordered" style="width:100%">
                        <thead>
                            <tr>
                                <th></th>
                                <th width="30%">Executante</th>
                                <th width="25%">Servico</th>
                                <th width="10%">Quant.</th>
                                <th width="15%">Vl. do serviço</th>
                                <th width="10%">Total</th>
                            </tr>
                        </thead>
                        <tfoot>
                            <tr>
                                <td id="fts" colspan="6" style="text-align:right"></td>
                            </tr>
                        </tfoot>
                    </table>
                    @Html.ValidationMessageFor(model => model.ServicosOS, null, new { @class = "text-danger" })

                    <div class="form-row">
                        @Html.EditorFor(model => model.CondicaoPagamento, "CondicaoPagamento/Select", new { Required = true, Disabled = false, @classForm = Util.Input10, flParcela = "S" })
                    </div>

                    @Html.HiddenFor(model => model.jsParcelasServicos)
                    <table id="tblParcelasServicos" class="table table-striped table-bordered" style="width:100%">
                        <thead>
                            <tr>
                                <th width="10%">Nº parcela</th>
                                <th width="15%">Valor Parcela</th>
                                <th width="10%">Vencimento</th>
                                <th width="55%">Forma de pagamento</th>
                            </tr>
                        </thead>
                    </table>
                </div>

                @*PRODUTO*@
                <div class="tab-pane fade" id="produto" role="tabpanel" aria-labelledby="home-tab">

                    @*<div class="bs-callout bs-callout-primary">*@
                    @*<h4> Produtos</h4>*@

                    <div id="divAddProduto">
                        <div class="form-row">
                            @Html.EditorFor(model => model.Produto, "Produtos/Select", new { Disabled = false, Required = true, flValor = "S", flUnidade = "S", flQuantidade = "S", flDesconto = "S", flTotalItem = "S", classForm = Util.Input10 })

                            <div style="margin-block:-1px">
                                <button id="addProduto" type="button" class="btn btn-success btn-lg" style="margin-top:35px; font-size:14px" title="Adicionar"><b>Adicionar </b> <i class="fa fa-plus"></i></button>
                            </div>
                        </div>
                    </div>

                    @Html.HiddenFor(model => model.jsProdutos)
                    <table id="tblProduto" class="table table-striped table-bordered" style="width:100%">
                        <thead>
                            <tr>
                                <th width="5%"></th>
                                <th width="5%">Cod</th>
                                <th width="35%">Produto</th>
                                <th width="10%">Unidade</th>
                                <th width="10%">Quant.</th>
                                <th width="15%">Vl. venda.</th>
                                <th width="10%">Desconto</th>
                                <th width="10%">Total</th>
                            </tr>
                        </thead>
                        <tfoot>
                            <tr>
                                <td id="ftp" colspan="8" style="text-align:right"></td>
                            </tr>
                        </tfoot>
                    </table>
                    @*</div>*@



                    <div class="form-row">
                        @Html.EditorFor(model => model.CondicaoPagamentoDois, "CondicaoPagamentoDois/Select", new { Required = true, Disabled = false, @classForm = Util.Input10, flParcela = "S" })
                    </div>

                    @Html.HiddenFor(model => model.jsParcelasProdutos)
                    <table id="tblParcelasProdutos" class="table table-striped table-bordered" style="width:100%">
                        <thead>
                            <tr>
                                <th width="10%">Nº parcela</th>
                                <th width="15%">Valor Parcela</th>
                                <th width="10%">Vencimento</th>
                                <th width="55%">Forma de pagamento</th>
                            </tr>
                        </thead>
                    </table>

                </div>
            </div>

            <div class="form-row">

                <div class="@Util.Input2">
                    @Html.Label("Total de serviços", new { @class = "no-required" })
                    @Html.TextBox("vlTotalServicos", "", new { @class = "form-control", Disabled = true, placeholder = "0,00", style = "text-align: right" })
                </div>

                <div class="@Util.Input2">
                    @Html.Label("Total de produtos", new { @class = "no-required" })
                    @Html.TextBox("vlTotalProdutos", "", new { @class = "form-control", Disabled = true, placeholder = "0,00", style = "text-align: right" })
                </div>
                <div class="@Util.Input2">
                    @Html.Label("Valor total", new { @class = "no-required" })
                    @Html.TextBoxFor(model => model.vlTotal, new { @class = "form-control", Disabled = true, placeholder = "0,00", style = "text-align: right" })
                </div>
            </div>

        </div>

        <div style="text-align:center">
            <button type="submit" class="btn btn-success" id="btnSalvar"> <i class="fa fa-save"></i> Salvar</button>
            <a href="@Url.Action(@Html.ViewBag.Action)" class="btn btn-primary" role="button" aria-pressed="true"> <i class="fa fa-times"></i> Limpar</a>
            <a href="@Url.Action("Edit", "OrdemServico", new { id = Model.codOrdemServico })" class="btn btn-secondary" role="button" aria-pressed="true"> <i class="fa fa-arrow-left"></i> Voltar</a>
        </div>
    </div>
}

@section scripts{
    <script type="text/javascript">
        var Action = {
            getParcelas: "@Url.Action("JsGetParcelas", "CondicaoPagamento")"
        }
    </script>
    @Scripts.Render("~/Scripts/Vendas/VendasOS.js")
}
